---
title: "Benchmark_figure_CD45er"
author: "Juraj Michalik"
date: "2023-08-19"
output: html_document
---
 File to build figures from benchmarked data. Load libraries, then benchmark tables.
 
```{r}
library(ggplot2)
library(dplyr)
library(tidyr)
```

```{r}
CD45er.benchmark <- read.csv('../Benchmarks/CD45er_benchmark_report.csv', sep = '\t') %>% dplyr::arrange(data, run)
IDAO.benchmark <- read.csv('../Benchmarks/IDEIS_benchmark_report.csv', sep = '\t') %>% dplyr::arrange(data, run)
complete.benchmark <- rbind(CD45er.benchmark, IDAO.benchmark)
complete.benchmark$data <- factor(complete.benchmark$data, 
                                  levels = c("GSE187515_2004", "GSE187515_2023Rep1", "GSE187515_2023Rep2", 
                                             "GSE212998_GFPpos_W1_pre_inf", "GSE212998_GFPpos_W2_pre_inf",
                                             "GSE212998_GFPpos_W1_inf", "GSE212998_GFPpos_W2_inf", "GSE212998_GFPneg_inf"))
```

Plot desired figure.

```{r, message=F, warning=F}
benchmark.plot <- ggplot(complete.benchmark, aes(x = data, y = CPU.time, fill = analysis)) +
  geom_bar(position = position_dodge(), stat = "summary", fun.y = "mean") +
  geom_jitter(aes(x = data), pch = 21, col = 'black', position = position_jitterdodge(jitter.width = 0.1), size = 2) + 
  theme_classic() + 
  scale_fill_manual(values = c('steelblue', 'darkorange1', 'darkorange3')) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
        legend.key.size = unit(1, 'cm'),
        legend.spacing.y = unit(0.5, 'cm'))

print(benchmark.plot)
```

Save figure.

```{r}
tiff('../GSE187515/Figure_6/Autogenerated/Figure_6/Benchmark.tiff', width = 7, height = 7, units = 'in', res = 200)
print(benchmark.plot)
dev.off()
```

Create blank variant.

```{r, message=F, warning=F}
benchmark.plot.blank <- ggplot(complete.benchmark, aes(x = data, y = CPU.time, fill = analysis)) +
  geom_bar(position = position_dodge(), stat = "summary", fun.y = "mean") +
  geom_jitter(aes(x = data), pch = 21, col = 'black', position = position_jitterdodge(jitter.width = 0.1), size = 2) + 
  theme_classic() + 
  ggtitle('')+
  xlab('') + ylab('') + 
  scale_fill_manual(values = c('steelblue', 'darkorange1', 'darkorange3')) +
  guides(fill = guide_legend(byrow = TRUE)) +
  theme(axis.text.x=element_blank(),
        axis.text.y=element_blank(),
        legend.title=element_blank(),
        legend.text=element_blank(),
        legend.key.size = unit(1, 'cm'),
        legend.spacing.y = unit(1, 'cm'))

print(benchmark.plot.blank)
```

Save it as well.

```{r}
tiff('../GSE187515/Figure_6/Autogenerated/Figure_6/Benchmark.tiff', width = 7, height = 5, units = 'in', res = 200)
print(benchmark.plot.blank)
dev.off()
```